<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Resident Registration</title>
  <link rel="stylesheet" href="index.css">
  <link rel="stylesheet" href="records.css">
  <style>
    * {
        box-sizing: border-box;
    }

    body {
      font-family: Arial, sans-serif;
    }
    input, select {
      width: 300px;
      padding: 8px;
      margin: 5px 0;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
    }
    th {
      background: #f4f4f4;
    }

    #residentForm {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        align-content: self-start;
        gap: 10px;
        /* border: 1px solid black; */
        

    }

    .submit_button {
        margin-top: 30px;
        justify-self: start;
        margin-bottom: 40px;
    }

    .submit_button:hover {
        cursor: pointer;
    }

  </style>
</head>
<body>
  <header>
    <nav>
        <div class="logo">Brgy. Pamanlinan Demographic Profiling System </div>
        <ul class="nav-links" id="navLinks">
            <li><a href="login.php">LOGOUT</a></li>
            <li><a href="add.php">Add people</a></li>
  
        </ul>
        <div class="burger" id="burger">&#9776;</div>
    </nav>
</header>





  <h2>RESIDENT REGISTRATION FORM</h2>

  <form id="residentForm">
        <input type="text" name="last_name" placeholder="Last Name" required>
        <input type="text" name="first_name" placeholder="First Name" required>
        <input type="text" name="middle_name" placeholder="Middle Name">
        <input type="text" name="ext" placeholder="Ext.">
        <select name="sex" required>
          <option value="">Select Sex</option>
          <option value="Male">Male</option>
          <option value="Female">Female</option>
        </select>
        <input type="text" name="street_name" placeholder="Street Name" required>
        <input type="text" name="purok_name" placeholder="Name of Purok" required>
        <input type="text" name="place_of_birth" placeholder="Place of Birth" required>
        <input type="date" name="date_of_birth" required>
        <input type="number" name="age" placeholder="Age" required>
        <input type="text" name="civil_status" placeholder="Civil Status" required>
        <input type="text" name="citizenship" placeholder="Citizenship" required>
   


    <select name="employment_status" required>
      <option value="">Employed/Unemployed</option>
      <option value="Employed">Employed</option>
      <option value="Unemployed">Unemployed</option>
    </select>
    <select name="solo_parent">
      <option value="">Solo Parent? Y/N</option>
      <option value="Yes">Yes</option>
      <option value="No">No</option>
    </select>
    <select name="ofw">
      <option value="">OFW? Y/N</option>
      <option value="Yes">Yes</option>
      <option value="No">No</option>
    </select>
    <input type="text" name="ofw_country" placeholder="If Yes, Country">
    <input type="text" name="occupation" placeholder="Occupation">
    <input type="text" name="toilet" placeholder="Toilet Type">
    <select name="out_of_school_youth">
      <option value="">Out of School Youth? Y/N</option>
      <option value="Yes">Yes</option>
      <option value="No">No</option>
    </select>
    <select name="pwd">
      <option value="">PWD? Y/N</option>
      <option value="Yes">Yes</option>
      <option value="No">No</option>
    </select>
    <input type="text" name="pwd_specify" placeholder="If Yes, Specify">
    <select name="indigenous_people">
      <option value="">Indigenous People? Y/N</option>
      <option value="Yes">Yes</option>
      <option value="No">No</option>
    </select>
    <input type="text" name="indigenous_tribe" placeholder="If Yes, Specify Tribe">
    <input type="text" name="cellphone_no" placeholder="Cellphone No.">
    <input type="text" name="facebook_account" placeholder="Facebook Account">
    <input type="text" name="valid_id_no" placeholder="Valid ID No.">
    <input type="text" name="type_of_id" placeholder="Type of ID">
    <button type="submit" class="submit_button">SUBMIT</button>
  </form>

  

  <script>
    const form = document.getElementById('residentForm');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const formData = new FormData(form);

      await fetch('save_data.php', {
        method: 'POST',
        body: formData
      });

      form.reset();
      fetchResidents();
    });

    async function fetchResidents(search = '') {
      const response = await fetch('fetch_data.php?search=' + encodeURIComponent(search));
      const data = await response.json();

      const tbody = document.querySelector('#residentTable tbody');
      tbody.innerHTML = '';

      data.forEach(resident => {
        const row = `<tr>
          <td>${resident.last_name}</td>
          <td>${resident.first_name}</td>
          <td>${resident.middle_name}</td>
          <td>${resident.sex}</td>
          <td>${resident.street_name}</td>
          <td>${resident.purok_name}</td>
          <td>${resident.age}</td>
        </tr>`;
        tbody.innerHTML += row;
      });
    }

    document.getElementById('searchInput').addEventListener('input', function() {
      fetchResidents(this.value);
    });

    fetchResidents();
  </script>

    


</body>
</html>
